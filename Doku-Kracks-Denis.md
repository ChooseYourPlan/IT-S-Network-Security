Man in the Harpoons

Der belgische Forscher Mathy Vanhoef hat im Jahre 2017 den KRACK wieder ins Leben gerufen. Laut seiner Aussage hat er ihn verbessert in der Sicherheitsanfälligkeit. Der sogenannte „Key-Reinstallation Attack“ oder auch KRACK genannt funktioniert potentiell gegen alle modernen geschützten Wi-Fi Verbindungen/Netzwerke(Stand 2017). Man kann mit dem KRACK die Daten manipulieren sowie abhören/abfragen. Das ist aber auf die Konfiguration des angegriffenen Zieles abhängig. Die einzige Limitation des Angreifers ist das er in Reichweite seines Ziels sein muss. Es betrifft aber nicht nur WPA2 Personal sondern auch Enterprise egal welche Verschlüsselungs-Chiffren das Netzwerk benutzt. Die anfälligsten Clients sind Linux und Android 6.0. Herr Vanhoef sagt selber das nicht die individuellen Produkte oder Implementationen unsicher sind sondern der Wi-Fi Standard selber. Zum verhindern der Attacken muss der User die betroffenen Produkte so schnell wie möglich updaten falls das Security-Update vorhanden ist. Der KRACK zielt auf den „Four-Way“ Handshake des WPA2 Protokolls ab und vertraut darauf, dass das Ziel-Gerät einen bereits vorhandenen Key benutzt. Diese Geschickte Vorgehensweise wird durch Manipulieren und Wiedergeben von kryptografischen Handshake-Nachrichten erreicht. Es basiert darauf das man Datenpakete klaut die vom aktuell benutzen Key sind die der Client benutzt.

Wie die reinstallation von ptk & gtk funktioniert

Die Installation des PTK geschieht indem man die Vierte Nachricht des FourWay Handshakes abfängt und dann der Client denkt das damit der Fourway Handshake beendet ist. Damit wird die Installation des Negation des Session Keys eingeleitet(PTK). Als Ergebnis wird ein Frame gesendet der nun als Transmitter gilt und damit kann man dann den Sicherheitslayer Encrypthen.<span id="anchor"></span>Die Installation des PTK geschieht indem man die Vierte Nachricht des FourWay Handshakes abfängt und dann der Client denkt das damit der Fourway Handshake beendet ist. Damit wird die Installation des Negation des Session Keys eingeleitet(PTK). Als Ergebnis wird ein Frame gesendet der nun als Transmitter gilt und damit kann man dann den Sicherheitslayer Encrypthen.

Fourway Handshake KRACK

Der erste Schritt ist das man als „Hacker“ eine multi-channel (MitM) (man in the middle Position) erlangen muss. Von hier aus kann man NICHT die decryption der Frames starten, hier kann man nur Nachrichten zwischen AP und Client blocken und verzögern. Dies erfolgt durch ein Tool. Einmal in dieser Position leitet man die ersten drei Nachrichten des FourWay Handshakes unverändert weiter, nicht jedoch die 4 Nachricht. Jedoch denkt der Client das der HS komplett ist was wiederum heißt das er den Negotiated Session Key installiert. Als Ergebnis kommt zu Stande das alle Daten des Clients die gesendet werden unverschlüsselt sind aber, weil der Router die vierte Message nicht bekommen hat ist der Handshake nicht abgeschlossen und somit sendet er eine neue Message 3 mit erhöhtem Counter. Wenn der Client die Nachricht bekommt sendet er eine neue Message 4 dazu kommt das er den PTK reinstalliert und reseted somit die Variablen und auch den Counter. Das löst aus das es die Variablen wieder benutzt und als Datenframe sendet. Dazu kommt das man Frames selber senden kann, da der replay counter reseted wurde.

Im Erste Schritt ist der erste Input der PMK Primary Master Key, beide haben diesen und es wird sicher gegangen das der PMK noch nie über das Wireless-Medium übertragen wurde. Der Zweite Input sind die Anonce die Authentifikationsnummern. Der dritte input sind die Snonce das ist die Clientnummer. Der vierte und fünfte Input sind die MAC-Adressen der teilnehmenden Stationen(Client AA Router SA). Das sind die Schritte um die Encrypthungkeys zu erstellen. Darauf hin antwortet der Client mit dem Snonce , da schon alle vollständigen Inputs vorhanden sind und somit kann es das die Snonce mit einem Message-Integrity-Code gesichert werden. Jetzt kann der Router die Snonce bestätigen, da Sie mit der MIC gesichert sind und somit sicher gegangen wird das Sie nicht sabotiert wurden. Jetzt bestätigt der Router den PTK (Pariwaise-Transient-Key) . Jetzt sendet der Router den GTK (Group-Temporal-Key) zu den Client ebenfalls ist dieser durch MIT geschützt. Jetzt installiert der Client den GTK und sendet dann nochmal eine Nachricht mit der Bestätigung das er den bekommen hat und das er beide jetzt installiert hat sowie startbereit ist für den Encrypted-Data Austausch.

WEP und attack eine spezifische attacke

 Wpa2 KRACKS warum es funktioniert

Wlan Protection Theo doku
